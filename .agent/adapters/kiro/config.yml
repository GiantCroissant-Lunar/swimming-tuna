name: kiro-ide
description: Kiro IDE adapter

capabilities:
  hooks: [fileEdited, promptSubmit, agentStop, preToolUse, postToolUse]
  mcp: true
  skills: true
  rules: true

sync:
  # Steering files — Kiro auto-includes these via front-matter
  steering_agents:
    target: .kiro/steering/agents.md
    action: pointer
    content: |
      ---
      inclusion: auto
      ---
      # Agent Guide

      See [AGENTS.md](../../AGENTS.md) for all project guidance.
      #[[file:AGENTS.md]]

  steering_conventions:
    target: .kiro/steering/conventions.md
    action: pointer
    content: |
      ---
      inclusion: auto
      ---
      #[[file:.agent/rules/conventions.md]]

  steering_security:
    target: .kiro/steering/security.md
    action: pointer
    content: |
      ---
      inclusion: auto
      ---
      #[[file:.agent/rules/security.md]]

  # Skills — copy SKILL.md files as Kiro manual-inclusion steering files
  skills:
    target: .kiro/skills/
    action: copy
    source: .agent/skills/
    glob: "*/SKILL.md"

  # Hooks — Kiro uses JSON hook files in .kiro/hooks/
  hooks:
    target: .kiro/hooks/
    action: merge
    format: kiro-hooks-json
    mapping:
      pre_tool_use.py:
        event: preToolUse
        toolTypes: ["write", "shell"]
        description: Validate tool calls against project security and convention rules
      supermemory-save:
        event: agentStop
        action: askAgent
        description: Save important decisions, findings, and context from this session to Supermemory
        prompt: >
          Review the conversation that just completed. If there were significant
          decisions, architectural findings, debugging insights, implementation patterns,
          or project knowledge worth preserving, save them to Supermemory by running:
          python .agent/skills/memory/scripts/save.py "<memory content>"
          Tag each memory with [swimming-tuna]. Focus on information that would help
          a future session pick up where this one left off. You can make multiple
          save calls for distinct topics. Skip saving if the conversation was trivial
          or exploratory with no actionable outcomes.
      supermemory-search:
        event: promptSubmit
        action: askAgent
        description: Search Supermemory for relevant context from prior sessions
        prompt: >
          Before responding to the user's message, search Supermemory for relevant
          prior context by running:
          python .agent/skills/memory/scripts/search.py "<keywords from user request>"
          If relevant memories are found, incorporate that context silently into your
          response. If nothing relevant is found or the search fails, proceed normally
          without mentioning the search.

  # Hooks config for shared Python hooks
  hooks_config:
    target: .kiro/hooks/config.json
    action: pointer
    content: |
      {"adapter": "kiro", "supermemory": {"enabled": true}}

  # Shared Python hooks (for runCommand hook actions)
  hooks_scripts:
    target: .kiro/hooks/
    action: copy
    source: .agent/hooks/
    glob: "*.py"

  # Shared lib (supermemory client etc.)
  lib:
    target: .kiro/lib/
    action: copy
    source: .agent/lib/
    glob: "*.py"
