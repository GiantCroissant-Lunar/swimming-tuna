{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "TaskState",
  "definitions": {
    "ErrorEnvelope": {
      "type": "object",
      "description": "Standardised error response body returned on 4xx/5xx responses.",
      "required": [
        "error"
      ],
      "properties": {
        "error": {
          "type": "string",
          "description": "Human-readable error message.",
          "examples": [
            "task not found",
            "invalid action id"
          ]
        },
        "taskId": {
          "type": [
            "string",
            "null"
          ],
          "description": "Task identifier associated with the error, when applicable."
        },
        "actionId": {
          "type": [
            "string",
            "null"
          ],
          "description": "Action identifier associated with the error, when applicable."
        },
        "reasonCode": {
          "type": [
            "string",
            "null"
          ],
          "description": "Machine-readable reason code.",
          "examples": [
            "not_found",
            "invalid_state",
            "actor_unavailable"
          ]
        }
      }
    },
    "HealthResponse": {
      "type": "object",
      "description": "Response body for the `/healthz` health check endpoint.",
      "required": [
        "ok"
      ],
      "properties": {
        "ok": {
          "type": "boolean",
          "description": "Always `true` when the runtime is reachable.",
          "examples": [
            true
          ]
        }
      }
    },
    "TaskState": {
      "type": "string",
      "enum": [
        "queued",
        "planning",
        "building",
        "reviewing",
        "done",
        "blocked"
      ],
      "description": "Lifecycle state of a swarm task."
    },
    "TaskSnapshot": {
      "type": "object",
      "description": "Full snapshot of a swarm task including all role outputs.",
      "required": [
        "taskId",
        "title",
        "description",
        "status",
        "createdAt",
        "updatedAt"
      ],
      "properties": {
        "taskId": {
          "type": "string",
          "description": "Unique task identifier."
        },
        "title": {
          "type": "string",
          "description": "Short human-readable task title."
        },
        "description": {
          "type": "string",
          "description": "Full task description."
        },
        "status": {
          "$ref": "#/definitions/TaskState"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp when the task was created."
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp of the last status update."
        },
        "planningOutput": {
          "type": [
            "string",
            "null"
          ],
          "description": "Output produced by the planner role."
        },
        "buildOutput": {
          "type": [
            "string",
            "null"
          ],
          "description": "Output produced by the builder role."
        },
        "reviewOutput": {
          "type": [
            "string",
            "null"
          ],
          "description": "Output produced by the reviewer role."
        },
        "summary": {
          "type": [
            "string",
            "null"
          ],
          "description": "Final summary when the task is completed."
        },
        "error": {
          "type": [
            "string",
            "null"
          ],
          "description": "Error message when the task has failed."
        },
        "parentTaskId": {
          "type": [
            "string",
            "null"
          ],
          "description": "Identifier of the parent task, if this is a sub-task."
        },
        "childTaskIds": {
          "type": [
            "array",
            "null"
          ],
          "items": {
            "type": "string"
          },
          "description": "Identifiers of child sub-tasks spawned by this task."
        }
      }
    },
    "TaskSummary": {
      "type": "object",
      "description": "Lightweight task representation used in list responses.",
      "required": [
        "taskId",
        "title",
        "status",
        "updatedAt"
      ],
      "properties": {
        "taskId": {
          "type": "string"
        },
        "title": {
          "type": "string"
        },
        "status": {
          "$ref": "#/definitions/TaskState"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        },
        "error": {
          "type": [
            "string",
            "null"
          ]
        }
      }
    },
    "MemoryTaskListResponse": {
      "type": "object",
      "description": "Response body for `GET /memory/tasks` containing a list of task snapshots.",
      "required": [
        "source",
        "items"
      ],
      "properties": {
        "source": {
          "type": "string",
          "description": "Backend that served the results (`arcadedb` or `registry`).",
          "enum": [
            "arcadedb",
            "registry"
          ]
        },
        "items": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/TaskSnapshot"
          }
        }
      }
    },
    "UiEventEnvelope": {
      "type": "object",
      "description": "A single event emitted by the AG-UI event stream.",
      "required": [
        "sequence",
        "type",
        "at",
        "payload"
      ],
      "properties": {
        "sequence": {
          "type": "integer",
          "format": "int64",
          "description": "Monotonically increasing sequence number."
        },
        "type": {
          "type": "string",
          "description": "Event type discriminator (e.g. `agui.task.snapshot`, `agui.task.status`, `agui.graph.node`, `agui.graph.edge`).\n"
        },
        "taskId": {
          "type": [
            "string",
            "null"
          ],
          "description": "Associated task identifier, when applicable."
        },
        "at": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp when the event was emitted."
        },
        "payload": {
          "type": "object",
          "additionalProperties": true,
          "description": "Event-specific payload; shape varies by `type`."
        }
      }
    },
    "UiActionRequest": {
      "type": "object",
      "description": "Action submitted by a UI client via the AG-UI actions gateway.",
      "required": [
        "actionId"
      ],
      "properties": {
        "taskId": {
          "type": [
            "string",
            "null"
          ],
          "description": "Target task identifier, required for task-scoped actions."
        },
        "actionId": {
          "type": "string",
          "description": "Action to perform. Supported values: `request_snapshot`, `refresh_surface`, `submit_task`, `load_memory`, `approve_review`, `reject_review`, `request_rework`, `pause_task`, `resume_task`, `approve_task`, `cancel_task`, `set_subtask_depth`.\n",
          "enum": [
            "request_snapshot",
            "refresh_surface",
            "submit_task",
            "load_memory",
            "approve_review",
            "reject_review",
            "request_rework",
            "pause_task",
            "resume_task",
            "approve_task",
            "cancel_task",
            "set_subtask_depth"
          ]
        },
        "payload": {
          "type": [
            "object",
            "null"
          ],
          "additionalProperties": true,
          "description": "Action-specific payload. For `submit_task`, provide `title` and optional `description` / `taskId` keys. For `set_subtask_depth`, provide `depth` (integer). For `load_memory`, provide optional `limit` (integer).\n"
        }
      }
    },
    "UiActionResponse": {
      "type": "object",
      "description": "Acknowledgement returned after a UI action is enqueued.",
      "required": [
        "actionId",
        "reasonCode"
      ],
      "properties": {
        "actionId": {
          "type": "string",
          "description": "Echoes the submitted `actionId`."
        },
        "taskId": {
          "type": [
            "string",
            "null"
          ],
          "description": "Target task identifier, when applicable."
        },
        "reasonCode": {
          "type": "string",
          "description": "Machine-readable outcome code (e.g. `accepted`)."
        }
      }
    },
    "A2aTaskSubmitRequest": {
      "type": "object",
      "description": "Payload for submitting a new agent-to-agent task.",
      "required": [
        "title"
      ],
      "properties": {
        "taskId": {
          "type": [
            "string",
            "null"
          ],
          "description": "Optional caller-supplied task identifier. Auto-generated if omitted."
        },
        "title": {
          "type": "string",
          "description": "Short human-readable task title."
        },
        "description": {
          "type": [
            "string",
            "null"
          ],
          "description": "Full task description."
        },
        "metadata": {
          "type": [
            "object",
            "null"
          ],
          "additionalProperties": true,
          "description": "Arbitrary caller-supplied metadata attached to the task."
        }
      }
    },
    "A2aTaskSubmitResponse": {
      "type": "object",
      "description": "Acknowledgement returned after an A2A task is accepted.",
      "required": [
        "taskId",
        "status",
        "statusUrl"
      ],
      "properties": {
        "taskId": {
          "type": "string",
          "description": "Assigned task identifier."
        },
        "status": {
          "type": "string",
          "description": "Always `accepted` on a successful submission.",
          "enum": [
            "accepted"
          ]
        },
        "statusUrl": {
          "type": "string",
          "description": "Relative URL to poll for task status."
        }
      }
    },
    "AgentCard": {
      "type": "object",
      "description": "A2A agent capability descriptor served at `/.well-known/agent-card.json`.\n",
      "required": [
        "name",
        "version",
        "protocol",
        "capabilities",
        "endpoints"
      ],
      "properties": {
        "name": {
          "type": "string"
        },
        "version": {
          "type": "string"
        },
        "protocol": {
          "type": "string",
          "description": "Protocol identifier (e.g. `a2a`)."
        },
        "description": {
          "type": [
            "string",
            "null"
          ]
        },
        "capabilities": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of capability tags advertised by this agent."
        },
        "endpoints": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "description": "Named endpoint URLs exposed by this agent."
        }
      }
    }
  },
  "type": "string",
  "enum": [
    "queued",
    "planning",
    "building",
    "reviewing",
    "done",
    "blocked"
  ],
  "description": "Lifecycle state of a swarm task."
}
