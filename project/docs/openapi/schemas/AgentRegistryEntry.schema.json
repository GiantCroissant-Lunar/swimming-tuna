{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "AgentRegistryEntry",
  "type": "object",
  "description": "Runtime registry entry describing a discovered or registered agent instance.",
  "required": [
    "agentId",
    "capabilities",
    "status",
    "sandboxLevel",
    "registeredAt",
    "lastHeartbeat",
    "consecutiveFailures",
    "circuitBreakerState"
  ],
  "properties": {
    "agentId": {
      "type": "string",
      "description": "Unique identifier for this agent instance."
    },
    "capabilities": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "List of capability tags advertised by this agent."
    },
    "status": {
      "type": "string",
      "description": "Current operational status of the agent."
    },
    "provider": {
      "type": [
        "object",
        "null"
      ],
      "description": "Provider configuration for the agent runtime.",
      "properties": {
        "adapter": {
          "type": "string",
          "description": "Adapter type for agent execution."
        },
        "type": {
          "type": "string",
          "description": "Provider type identifier."
        },
        "plan": {
          "type": "string",
          "description": "Service plan or tier."
        }
      }
    },
    "sandboxLevel": {
      "type": "integer",
      "description": "Isolation level: 0=BareCli, 1=OsSandboxed, 2=Container",
      "enum": [
        0,
        1,
        2
      ]
    },
    "budget": {
      "type": [
        "object",
        "null"
      ],
      "description": "Token budget tracking for the agent.",
      "properties": {
        "type": {
          "type": "string",
          "description": "Budget type identifier."
        },
        "totalTokens": {
          "type": "integer",
          "description": "Total token allocation."
        },
        "usedTokens": {
          "type": "integer",
          "description": "Tokens consumed so far."
        },
        "remainingFraction": {
          "type": "number",
          "description": "Fraction of budget remaining (0.0 to 1.0)."
        }
      }
    },
    "endpointUrl": {
      "type": [
        "string",
        "null"
      ],
      "description": "Base URL for communicating with this agent instance."
    },
    "registeredAt": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when the agent was registered."
    },
    "lastHeartbeat": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of the last successful heartbeat."
    },
    "consecutiveFailures": {
      "type": "integer",
      "description": "Number of consecutive health check failures."
    },
    "circuitBreakerState": {
      "type": "string",
      "description": "Circuit breaker state (e.g., 'closed', 'open', 'half-open')."
    }
  }
}
